const createCsvWriter = require('csv-writer').createObjectCsvWriter;
const fs = require('fs');
const path = require('path');

function decomposeAddress(address) {
    const parts = address.split(' ');

    let postalCodeIndex = -1;
    let streetIndex = -1;

    // Find the index of the postal code
    for (let i = 0; i < parts.length; i++) {
        if (/^\d{4}$/.test(parts[i])) {
            postalCodeIndex = i;
            break;
        }
    }

    // Check if the postal code is found
    if (postalCodeIndex !== -1) {
        const beforePostalCode = parts[postalCodeIndex - 1];
        if (beforePostalCode) {
            if (beforePostalCode.includes('-')) {
                streetIndex = postalCodeIndex - 1;
            }
            else if (!isNaN(+beforePostalCode)) {
                streetIndex = postalCodeIndex - 1;
            }
            else if (isNaN(+beforePostalCode) && !isNaN(+parts[postalCodeIndex - 2])) {
                streetIndex = postalCodeIndex - 2;
            }
        }
    }

    let road = '';
    let street = '';

    if (streetIndex !== -1) {
        road = parts.slice(0, streetIndex).join(' ');
        street = parts[streetIndex];
    } else if (postalCodeIndex > 0) {
        // street = parts[postalCodeIndex - 1];
        road = parts.slice(0, postalCodeIndex).join(' ');
    } else {
        // street = parts[0];
        road = '';
        street = '';
    }

    const postalCode = parts[postalCodeIndex];
    const city = parts.slice(postalCodeIndex + 1).join(' ');

    return {
        road: road,
        street: street,
        postalCode: postalCode,
        city: city
    };
}

// Example usage
let adresses = [
    "Marktgasse 60 4310 Rheinfelden",
    "Obere Gletscherstrasse 1 3818 Grindelwald",
    "Via Collinetta 78 6612 Ascona",
    "Rablüzza 158 7550 Scuol",
    "Am Wasser 3 8600 Dübendorf",
    "Via Giuseppe Cattori 6 6600 Locarno",
    "3823 Wengen",
    "Route du Centre Thermal 16 1913 Saillon",
    "Zentrum 4 6356 Rigi",
    "Staatsstrasse 1 3652 Hilterfingen",
    "Route des Bains 48 1892 Lavey-les-Bains",
    "Riedweg 156 3920 Zermatt",
    "Seestrasse 22 3806 Bönigen b. Interlaken",
    "Neuengasse 15 Postfach 3001 Bern",
    "Seminarstrasse 10 6285 Hitzkirch",
    "Dorfstrasse 133 3818 Grindelwald",
    "Chemin du Vernex 9 1865 Les Diablerets",
    "Voa principala Postfach 19 7077 Valbella",
    "Hauptstrasse 34 9042 Speicher",
    "Via Cassarinetta 6 6900 Lugano",
    "Dorfplatz 7514 Sils / Segl Maria",
    "Via San Salvatore 11 6902 Paradiso",
    "Via nova 38 7017 Flims Dorf",
    "Dorfstrasse 10 6443 Morschach",
    "Freimettigenstrasse 9 3510 Konolfingen",
    "Via dal Corvatsch 76 7513 Silvaplana",
    "Blausee 222 3717 Blausee",
    "Industriestrasse 3 6210 Sursee",
    "Centralbahnhofplatz 14 4002 Basel",
    "Via Castell 50 7524 Zuoz",
    "Neuengasse 15 Postfach 3001 Bern",
    "Wassbergstrasse 62 8127 Forch",
    "Blomattenweg 2 3906 Saas-Fee",
    "Schaffhauserstrasse 1 8006 Zürich",
    "Badenstrasse 1 4057 Basel",
    "7563 Samnaun Dorf",
    "Spitalgasse 3 8001 Zürich",
    "Chemin du Cerisier 8-10 1004 Lausanne",
    "Flecklistrasse 40 3715 Adelboden",
    "Neuengasse 15 Postfach 3001 Bern",
    "Bahnhofstrasse 30 6000 Luzern",
    "Stauffacherquai 1 8004 Zürich",
    "Seestrasse 66 9320 Arbon",
    "Bahnhofstrasse 2 3900 Brig",
    "Roberstenstrasse 31 4310 Rheinfelden",
    "Bernhard Simon Strasse 1 7310 Bad Ragaz",
    "Freiburgstrasse 2 1712 Tafers",
    "Löwenplatz 5612 Villmergen",
    "Chemin du Mont-Blanc 1 CP-179, Plans-Mayens 3963 Crans-Montana",
    "Via Rosatsch 18 7500 St. Moritz",
    "Voa principala 39 Postfach 940 7078 Lenzerheide/Lai",
    "Gwattstrasse 4 3604 Thun",
    "Terracestrasse 33 6390 Engelberg",
    "Hertensteinstrasse 42 6353 Weggis",
    "Linde 115 3803 Beatenberg",
    "Balmstrasse 3 6045 Meggen",
    "Langgasse 9 6340 Baar",
    "Klibenstrasse 19 3954 Leukerbad",
    "Oltnerstrasse 11 4622 Egerkingen",
    "Untere Mattenstrasse 12 3920 Zermatt",
    "3920 Zermatt",
    "Seestrasse 80 6354 Vitznau",
    "address",
    "Marktgasse 60 4310 Rheinfelden",
    "Obere Gletscherstrasse 1 3818 Grindelwald",
    "Via Collinetta 78 6612 Ascona",
    "Rablüzza 158 7550 Scuol",
    "Am Wasser 3 8600 Dübendorf",
    "Via Giuseppe Cattori 6 6600 Locarno",
    "3823 Wengen",
    "Route du Centre Thermal 16 1913 Saillon",
    "Zentrum 4 6356 Rigi",
    "Staatsstrasse 1 3652 Hilterfingen",
    "Route des Bains 48 1892 Lavey-les-Bains",
    "Riedweg 156 3920 Zermatt",
    "Seestrasse 22 3806 Bönigen b. Interlaken",
    "Neuengasse 15 Postfach 3001 Bern",
    "Seminarstrasse 10 6285 Hitzkirch",
    "Dorfstrasse 133 3818 Grindelwald",
    "Chemin du Vernex 9 1865 Les Diablerets",
    "Voa principala Postfach 19 7077 Valbella",
    "Hauptstrasse 34 9042 Speicher",
    "Via Cassarinetta 6 6900 Lugano",
    "Dorfplatz 7514 Sils / Segl Maria",
    "Via San Salvatore 11 6902 Paradiso",
    "Via nova 38 7017 Flims Dorf",
    "Dorfstrasse 10 6443 Morschach",
    "Freimettigenstrasse 9 3510 Konolfingen",
    "Via dal Corvatsch 76 7513 Silvaplana",
    "Blausee 222 3717 Blausee",
    "Industriestrasse 3 6210 Sursee",
    "Centralbahnhofplatz 14 4002 Basel",
    "Via Castell 50 7524 Zuoz",
    "Neuengasse 15 Postfach 3001 Bern",
    "Wassbergstrasse 62 8127 Forch",
    "Blomattenweg 2 3906 Saas-Fee",
    "Schaffhauserstrasse 1 8006 Zürich",
    "Badenstrasse 1 4057 Basel",
    "7563 Samnaun Dorf",
    "Spitalgasse 3 8001 Zürich",
    "Chemin du Cerisier 8-10 1004 Lausanne",
    "Flecklistrasse 40 3715 Adelboden",
    "Neuengasse 15 Postfach 3001 Bern",
    "Bahnhofstrasse 30 6000 Luzern",
    "Stauffacherquai 1 8004 Zürich",
    "Seestrasse 66 9320 Arbon",
    "Bahnhofstrasse 2 3900 Brig",
    "33, Quai des Bergues 1201 Genève",
    "Roberstenstrasse 31 4310 Rheinfelden",
    "Bernhard Simon Strasse 1 7310 Bad Ragaz",
    "Freiburgstrasse 2 1712 Tafers",
    "Löwenplatz 5612 Villmergen",
    "Chemin du Mont-Blanc 1 CP-179, Plans-Mayens 3963 Crans-Montana",
    "Via Rosatsch 18 7500 St. Moritz",
    "Voa principala 39 Postfach 940 7078 Lenzerheide/Lai",
    "Gwattstrasse 4 3604 Thun",
    "Terracestrasse 33 6390 Engelberg",
    "Hertensteinstrasse 42 6353 Weggis",
    "Linde 115 3803 Beatenberg",
    "Balmstrasse 3 6045 Meggen",
    "Langgasse 9 6340 Baar",
    "Klibenstrasse 19 3954 Leukerbad",
    "Oltnerstrasse 11 4622 Egerkingen",
    "Untere Mattenstrasse 12 3920 Zermatt",
    "3920 Zermatt",
    "Seestrasse 80 6354 Vitznau",
    "Gletscherstrasse 14 3906 Saas-Fee",
    "Dorfstrasse 47 3652 Hilterfingen",
    "Hauptstrasse 9 7494 Davos-Wiesen",
    "Autostrada A2 6513 Monte Carasso-Bellinzona",
    "Via delle Scuole 17 6612 Ascona",
    "Riva A. Caccia 7 6900 Lugano",
    "Laupenstrasse 15 City West 3001 Bern",
    "Avenue Viollier 1 1260 Nyon",
    "Dorfstrasse 75 3818 Grindelwald",
    "Seerosenstrasse 1 5616 Meisterschwanden",
    "Kloster Fischingen 8376 Fischingen",
    "Quai du Mont-Blanc 19 Case postale 176 1211 Genève",
    "Chemin des Cibles 17 1997 Haute-Nendaz",
    "Unterdorfstrasse 21 8808 Pfäffikon SZ",
    "Dorfstrasse 40 6390 Engelberg",
    "Oberdorfstrasse 1 3812 Wilderswil",
    "Frutt 9 6068 Melchsee-Frutt",
    "Route des Bains 1911 Ovronnaz",
    "Rue de l'Hôtel de Ville 16 1470 Estavayer-le-Lac",
    "Hauptgasse 64 4500 Solothurn",
    "Zelgweg 11 5405 Baden-Dättwil",
    "Via Campagnola 12 6575 Vairano",
    "Ryf 53 3280 Murten",
    "Badenerstrasse 537 8048 Zürich",
    "Furkastrasse 3985 Münster VS",
    "Riethofstrasse 40 8152 Opfikon",
    "Dorfstrasse 99 3718 Kandersteg",
    "Stadthausstrasse 4 8400 Winterthur",
    "Sigriswilstrasse 117 3655 Sigriswil",
    "Splügenstrasse 2 8002 Zürich",
    "7514 Sils / Segl Maria",
    "St. Leodegarstrasse 3 6006 Luzern",
    "In Gassen 10 8001 Zürich",
    "Artherstrasse 1 6318 Walchwil",
    "Promenade 159 7260 Davos Dorf",
    "Bielweg 4 3934 Zeneggen",
    "3823 Wengen",
    "Route de Chardonne 1071 Chexbres",
    "Quai des Bergues 21 1201 Genève",
    "Höheweg 94 3800 Interlaken",
    "Gletscherstrasse 1 3906 Saas-Fee",
    "Rue de Bon-Port 35 1820 Montreux",
    "Seftigenstrasse 99 3007 Bern",
    "Steinmattstrasse 85 3920 Zermatt",
    "Rathausstrasse 51 3954 Leukerbad",
    "Route du Rawyl 42 3963 Crans-Montana",
    "Muhenstrasse 58 5036 Oberentfelden",
    "Hardstrasse 55 4133 Pratteln",
    "Risetensträssli 10 3715 Adelboden",
    "7504 Pontresina",
    "Via Somplaz 17 7500 St. Moritz",
    "Wispilenstrasse 29 3780 Gstaad",
    "Via Maistra 157 7504 Pontresina",
    "Seestrasse 47 3602 Thun",
    "Bernstrasse 4 4665 Oftringen",
    "Avenue de Mategnin 21 1217 Meyrin",
    "Baarerstrasse 97 6300 Zug",
    "Bahnhofplatz 9001 St. Gallen",
    "Gerschniweg 1 6390 Engelberg",
    "Via Sorts Sut 3 7018 Flims Waldhaus",
    "Via Valle 20 Caslano 6957 Roveredo TI",
    "Zona Campra 6718 Olivone",
    "Rheingasse 2 4058 Basel",
    "Saanenmöserstrasse 168 3777 Saanenmöser",
    "Via Serpiano 6867 Serpiano",
    "Furkastrasse 133 3985 Münster-Geschinen",
    "Dorf 3997 Bellwald",
    "Zähringerstrasse 21 8001 Zürich",
    "Staatsstrasse 142 3626 Hünibach",
    "Steinmattweg 7 3920 Zermatt",
    "3825 Mürren",
    "Poststrasse 12 8001 Zürich",
    "Bahnhofstrasse 12 7250 Klosters",
    "Hauptstrasse 25 7516 Maloja",
    "Via Nova 80 7071 Flims",
    "Via Geretta 15 6902 Paradiso",
    "Bahnhofstrasse 22 3920 Zermatt",
    "Riffelalp 3920 Zermatt",
    "Matterstrasse 23 3920 Zermatt",
    "Gotthardstrasse 11 6353 Weggis",
    "Hafenstrasse 4 8853 Lachen SZ",
    "Saastalstrasse 118 3910 Saas-Grund",
    "Palacestrasse 28 3780 Gstaad",
    "20, route de Pré-Bois Case postale 556 1215 Genève 15 Aéroport",
    "Brunngässlein 8 4052 Basel",
    "Kurparkstrasse 24 - 25 3954 Leukerbad",
    "Lungolago G. Motta 27 6612 Ascona",
    "19, rue de Zurich 1211 Genève",
    "Hinterbergstrasse 41 6318 Walchwil",
    "Aegerten 1079C 3825 Mürren",
    "Route de Montana 2 3974 Mollens VS",
    "Holzstrasse 15 9010 St. Gallen",
    "Place Longemalle 17 1204 Genève",
    "Dorfstrasse 9 7563 Samnaun Dorf",
    "Via Mezdi 33 7500 St. Moritz",
    "Flughofstrasse 75 8153 Rümlang",
    "Rue de Médran 70 1936 Verbier",
    "Seestrasse 10 Postfach 96 1716 Schwarzsee",
    "Innere Poststrasse 7050 Arosa",
    "Bahnhofplatz 1 3860 Meiringen",
    "Avenue de la Sallaz 8 1005 Lausanne",
    "Seedammstrasse 3 8808 Pfäffikon SZ",
    "Talstrasse 1 8001 Zürich",
    "Landstrasse 170 7250 Klosters",
    "Promenade 116 7260 Davos",
    "Via Cantonale 39 6592 S. Antonino",
    "Aegertenstrasse 1 3775 Lenk im Simmental",
    "Hauptstrasse 155 7075 Churwalden",
    "Rue du Petit-Chêne 34 1003 Lausanne",
    "Quai Turrettini 1 Case postale 2040 1201 Genève",
    "Kirchplatz 30 4800 Zofingen",
    "Promenade 63 7270 Davos Platz",
    "Franziskanerplatz 12 6003 Luzern",
    "Voa principala 7077 Valbella",
    "Messeplatz 12 4058 Basel",
    "Gotthardstrasse 6 6353 Weggis",
    "Schiffbaustrasse 13 8005 Zürich",
    "Grand'Rue 27 2108 Couvet",
    "Hamelirainstrasse 3 8302 Kloten",
    "Bahnhofstrasse 30 6000 Luzern",
    "Alte Winterthurerstrasse 16 8304 Wallisellen",
    "Clarastrasse 43 4058 Basel",
    "Prätschlistrasse 38 7050 Arosa",
    "Schauplatzgasse 10 3011 Bern",
    "Raftstrasse 6 3655 Sigriswil",
    "Rondellstrasse 8058 Zürich",
    "Universitätstrasse 101 8006 Zürich",
    "Seestrasse 45 3600 Thun",
    "Place de la Gare 2 2000 Neuchâtel",
    "Terrassenweg 104 3818 Grindelwald",
    "Veia Stradung 7460 Savognin",
    "Place du Port 5 1006 Lausanne",
    "Rebgasse 12-14 4058 Basel",
    "Seestrasse 856 8706 Meilen",
    "3825 M�rren",
    "Gotthardstrasse 4 6353 Weggis",
    "Bärengasse 1 6490 Andermatt",
    "Wiesenbachstrasse 5 9030 Abtwil SG",
    "Gratstrasse 8143 Uetliberg",
    "Sihlstrasse 31 8001 Zürich",
    "The Circle 41 8058 Zurich Airport",
    "7514 Sils / Segl Maria",
    "Dorfstrasse 53 3818 Grindelwald",
    "3925 Grächen",
    "Vea Valetta 26 7457 Bivio",
    "Via Veglia 18 7500 St. Moritz",
    "Stoffelberg 3706 Leissigen",
    "Avenue Ignace-Paderewski 8 1110 Morges",
    "Egglistrasse 24 3780 Gstaad",
    "Im Zentrum 2 8105 Regensdorf",
    "Rue du Cygne 1 2900 Porrentruy",
    "Bahnhofstrasse 14 2502 Biel",
    "Blattenstrasse 62 3919 Blatten (Lötschen)",
    "Industriestrasse 14 6304 Zug",
    "Via Maistra 145 7504 Pontresina",
    "Dorfweg 1 3906 Saas-Fee",
    "Badenerstrasse 420 8040 Zürich",
    "Talstrasse 43 3905 Saas-Almagell",
    "Piazza Indipendenza 1 6830 Chiasso",
    "Höheweg 7 3800 Interlaken",
    "Hohgeblätt 9 3905 Saas-Almagell",
    "Wartensee 1 9404 Rorschacherberg",
    "Seestrasse 300 3658 Merligen",
    "Rue du Marché 1 1820 Montreux",
    "Eichhörnliweg 1 7050 Arosa",
    "Route du Petit Signal 3 3963 Crans-Montana",
    "Museggstrasse 2 6004 Luzern",
    "Am Platz 3 7310 Bad Ragaz",
    "Eichenstrasse 1 Postfach 6203 Sempach Station",
    "Route de la Forêt 6 1986 Arolla",
    "Gostenstrasse 20 8882 Unterterzen",
    "Engestrasse 54 3012 Bern",
    "Bodenplatz 2 7435 Splügen",
    "Wengiboden 1352a 3823 Wengen",
    "Schlossweg 1 6010 Kriens",
    "Adligenswilerstrasse 22 6002 Luzern",
    "Kornhausstrasse 3 3013 Bern",
    "Via F. Borromini 10 6850 Mendrisio",
    "Kurhausstrasse 65 8032 Zürich",
    "Brunnmatt 6 6330 Cham",
    "Rue des Sondzons 22 1904 Vernayaz",
    "Hauptstrasse 23 8872 Weesen",
    "Kantonsstrasse 3 4416 Bubendorf",
    "Dorfstrasse 14 3778 Schönried",
    "Wallisellenstrasse 48 8050 Zürich",
    "Obere Hauptgasse 2 3600 Thun",
    "Rue du Bourg 22 3960 Sierre",
    "3992 Bettmeralp",
    "Via Muraccio 142 6612 Ascona",
    "7050 Arosa",
    "3823 Wengen",
    "Neuengasse 15 Postfach 3001 Bern",
    "Chemin du Genévrier 20 1806 Blonay-St-Légier",
    "Hertensteinstrasse 156 6353 Weggis",
    "Spissstrasse 52 3920 Zermatt",
    "Alte Bahnhofstrasse 1 7250 Klosters",
    "Neuengasse 15 Postfach 3001 Bern",
    "Hauptgasse 42 4500 Solothurn",
    "Blumenrain 8 4001 Basel",
    "Messeplatz 25 4005 Basel",
    "Appenbergstrasse 36 3532 Zäziwil",
    "Seestrasse 108 3800 Unterseen",
    "Im Feldbach 10 8266 Steckborn",
    "Rte de la Cité 4 1854 Leysin",
    "Pfingstweidstrasse 100 8005 Zürich",
    "Via Salastrains 12 7500 St. Moritz",
    "6921 Vico Morcote",
    "8532 Warth",
    "Via Albarelle 16 6612 Ascona",
    "Neudorfstrasse 50 7430 Thusis",
    "Matterstrasse 43 3920 Zermatt",
    "Bahnhofstrasse 87 8001 Zürich",
    "Dorfstrasse 74 3792 Saanen",
    "Rue St-Jean 26 1260 Nyon",
    "Rathausstrasse 36 3954 Leukerbad",
    "Deltaweg 29 3645 Gwatt (Thun)",
    "Via Nassa 68 Piazza Luini 6901 Lugano",
    "7505 Celerina / Schlarigna",
    "St. Jakob-Strasse 1 4132 Muttenz",
    "Neuengasse 15 Postfach 3001 Bern",
    "Haltenstrasse 10 3906 Saas-Fee",
    "3920 Zermatt",
    "Route de Verbier Station 55 1936 Verbier",
    "Via Carona 27 6900 Lugano",
    "7050 Arosa",
    "Via Montalbano 5 6900 Lugano",
    "Badstrasse 20 3775 Lenk im Simmental",
    "Bahnhofstrasse 5 7260 Davos Dorf",
    "Poststrasse 560 7132 Vals",
    "Flughafenstrasse 215 4056 Basel",
    "Zentralstrasse 4 6003 Luzern",
    "3987 Riederalp",
    "Hauptgasse 79 4500 Solothurn",
    "1923 Les Marécottes",
    "Aspen 1 3818 Grindelwald",
    "Heidi-Abel-Weg 5 8050 Zürich",
    "Chemin de la Fontaine 2 1805 Jongny",
    "Bahnhofstrasse 5 3920 Zermatt",
    "Av. du Grand-Champsec, 23 1950 Sion",
    "Place Centrale 2 1936 Verbier",
    "Rössligasse 7 8001 Zürich",
    "Avenue du Midi 6 1950 Sion",
    "Via Traunter Plazzas 7 7500 St. Moritz",
    "7515 Sils / Segl Baselgia",
    "Route de Tolochenaz 1110 Morges",
    "Heimine 468 3925 Grächen",
    "via Bertogna 4 6614 Brissago",
    "Hafenzentrum 9400 Rorschach",
    "Bruggerstrasse 56 5400 Baden",
    "Boscaweg 7 7252 Klosters Dorf",
    "Via Dimlej 6 7500 St. Moritz",
    "6410 Rigi Kulm",
    "Via Henri Guisan 1 6500 Bellinzona",
    "Hirschengraben 64 8001 Zürich",
    "Moosstrasse 40 3920 Zermatt",
    "Ringstrasse 10 6433 Stoos SZ",
    "Säumerstrasse 37 8803 Rüschlikon",
    "Zollrain 16 5000 Aarau",
    "Avenue des Bains 9 1400 Yverdon-les-Bains",
    "Seestrasse 86 8267 Berlingen",
    "Dorfstrasse 12 6375 Beckenried",
    "Rigi Staffelhöhe 6356 Rigi Kaltbad",
    "Muglin vegl 7551 Ftan",
    "Berneggstrasse 2 9000 St. Gallen",
    "Sonnenbergstrasse 7050 Arosa",
    "Bodmenstrasse 12 3920 Zermatt",
    "Comercialstrasse 32 7000 Chur",
    "Schibernstrasse 2 6354 Vitznau",
    "Bahnhofstrasse 8 6440 Brunnen",
    "Gottardo Madonna1 6622 Ronco sopra Ascona",
    "3988 Obergesteln",
    "Neuengasse 15 Postfach 3001 Bern",
    "Obere Dorfstrasse 30 3906 Saas-Fee",
    "Rue du Centre sportif 37 1936 Verbier",
    "Lomattenstrasse 7 3906 Saas-Fee",
    "Bellevuestrasse 15 3715 Adelboden",
    "Gotthardstrasse 58 6490 Andermatt",
    "Pré-du-Lac 2416 Les Brenets",
    "Moosegg 231a 3543 Emmenmatt",
    "Place de Savoie 1 1260 Nyon",
    "Schlossweg 1 6010 Kriens",
    "Route des Hôtels 28 1884 Villars-sur-Ollon",
    "Via dal Bagn 6 7500 St. Moritz",
    "Via a Brentsch 417 7550 Scuol",
    "Via Montalbano 6925 Lugano",
    "Dorfstrasse 33 6390 Engelberg",
    "Rue de l'Arquebuse 20 1204 Genève",
    "Gryfelblatte 4 3920 Zermatt",
    "Gsteigstrasse 51 3780 Gstaad",
    "Voia Principale 73 7083 Lantsch/Lenz",
    "Grubenstrasse 5 8620 Wetzikon ZH",
    "Crusch Plantaun 217 7527 Brail",
    "Max Bill-Platz 19 8050 Zürich",
    "Route des Zirès 3963 Crans-Montana",
    "Seidenhofstrasse 5 6002 Luzern",
    "Utoquai 47 8008 Zürich",
    "Rorschacher Strasse 311 9016 St. Gallen",
    "Route du Col des Mosses 104 1862 Les Mosses",
    "Dorfstrasse 6086 Hasliberg Reuti",
    "Schachenstrasse 43 3700 Spiez",
    "Furi 265 3920 Zermatt",
    "Dossen 1 6073 Flüeli-Ranft",
    "Schönaustrasse 10 4058 Basel",
    "12, route des jeunes Carouge 1227 Carouge GE",
    "Hertensteinstrasse 34 6353 Weggis",
    "Seestrasse 89 1716 Schwarzsee",
    "Auf dem Fels 3920 Zermatt",
    "Route du Lac 54 1938 Champex-Lac",
    "Hurdnerstrasse 137 8640 Hurden",
    "Chappelmattweg 4 6402 Merlischachen",
    "Dorfstrasse 19 3715 Adelboden",
    "Dorfstrasse 5 3715 Adelboden",
    "Bahnhofstrasse 28 3920 Zermatt",
    "Riggenbachstrasse 10 4600 Olten",
    "Talstrasse 28 3922 Stalden VS",
    "Tobelmühlestrasse 2 Postfach 13 7270 Davos Platz",
    "Via Lugano 18 6988 Ponte Tresa - Lugano",
    "Wasserfallstrasse 108 6390 Engelberg",
    "Viale Verbano 29 6600 Muralto",
    "Vispastrasse 52 3920 Zermatt",
    "Via Lido 20 6612 Ascona",
    "Stradun 169 7550 Scuol",
    "Bahnhofstrasse 16 8800 Thalwil",
    "Malbunstrasse 60 9497 Triesenberg",
    "Postfach 103 3818 Grindelwald",
    "Römerstrasse 24 5400 Baden",
    "Route des Zirès 14 3963 Crans-Montana",
    "Chemin des Vignes 14 1027 Lonay",
    "Scalinata della Ruga 4 6612 Ascona",
    "Seestrasse 120 8700 Küsnacht ZH",
    "Kolinplatz 11 6300 Zug",
    "Höheweg 74 3800 Interlaken",
    "Avenue des Alpes 45 1820 Montreux",
    "Hertensteinstrasse 48 6353 Weggis",
    "Riedweg 35 3920 Zermatt",
    "Kantonsstrasse 2 3944 Unterbäch VS",
    "Panezlis 63 7064 Tschiertschen",
    "Via Sela 11 7500 St. Moritz",
    "Alte Spinnerei 12 8877 Murg",
    "Kemmeriboden 6197 Schangnau",
    "Quai du Mont-Blanc 11 1211 Genève",
    "Wiestistrasse 7 3920 Zermatt",
    "Via da la Staziun 2 7504 Pontresina",
    "Am Guisanplatz 2 3014 Bern",
    "Via San Gian 23 7500 St. Moritz",
    "Langstrasse 150 8004 Zürich",
    "Voa Principala 41 Postfach 126 7078 Lenzerheide/Lai",
    "3992 Bettmeralp",
    "Via Crasta 3 7500 St. Moritz",
    "Via Tegiatscha 1 7500 St. Moritz",
    "Route de la Prairie 34 3963 Crans-Montana",
    "Stansstaderstrasse 20a 6370 Stans",
    "3906 Saas-Fee",
    "Grünaustrasse 2 9470 Buchs SG",
    "Kirchstrasse 17 3920 Zermatt",
    "Lauenenstrasse 19 3780 Gstaad",
    "Via Maistra 7537 Müstair",
    "Pfalzgasse 1 8001 Zürich",
    "Hauptgasse 64 4500 Solothurn",
    "Orellistrasse 21 8044 Zürich",
    "Hauptstrasse 61 4566 Kriegstetten",
    "Wasserfallstrasse 6 6390 Engelberg",
    "Chemin des Sports 10 2350 Saignelégier",
    "Seewaldstrasse 12 7050 Arosa",
    "Via da Tarasp 518 7550 Scuol",
    "Guido A. Zäch Str. 2 6207 Nottwil",
    "3825 Mürren",
    "Landstrasse 190 7250 Klosters",
    "Dorfplatz 7132 Vals",
    "Rheingasse 19 4058 Basel",
    "Riedstrasse 18 3920 Zermatt",
    "Via Chasellas 1 7500 St. Moritz",
    "Am Grimselpass 3864 Guttannen",
    "Seestrasse 10 6314 Unterägeri",
    "Kreuzäckerstrasse 5 8957 Spreitenbach",
    "Oberseepromenade 2 7050 Arosa",
    "Dr. Martin-Erbstrasse 5 5330 Bad Zurzach",
    "7457 Bivio",
    "Via dils Larischs 7 7018 Flims",
    "Riva A. Caccia 10 6902 Paradiso",
    "7018 Flims Waldhaus",
    "Mattenstrasse 1 6343 Rotkreuz",
    "7563 Samnaun",
    "Luzernerstrasse 31 5643 Sins",
    "Seestrasse 58 3700 Spiez",
    "Metallstrasse 20 6300 Zug",
    "Bahnhofplatz 7 8001 Zürich",
    "Gwattstrasse 1 3604 Thun",
    "Buckhauserstrasse 36 Postfach 8048 Zürich",
    "Rue du Conseil 27 1800 Vevey",
    "Engimattstrasse 14 8002 Zürich",
    "Via Principale 25 7746 Le Prese",
    "Via Johannes Badrutt 11 7500 St. Moritz",
    "Seestrasse 16 3800 Unterseen",
    "Neumühlequai 42 8006 Zürich",
    "Hahnenmoosstrasse 34 3715 Adelboden",
    "Vi 383 7550 Scuol",
    "Riva Antonio Caccia 10 6900 Lugano",
    "Zürcherstrasse 72 8953 Dietikon",
    "Bürgenstock 6363 Obbürgen",
    "3807 Iseltwald",
    "Rue du Centre Sportif 24 1936 Verbier",
    "In der Hard 4127 Birsfelden",
    "Golfpanorama 8564 Lipperswil",
    "3855 Brienz BE",
    "Hannigstrasse 47 3906 Saas-Fee",
    "Voa plam nesa 2 7078 Lenzerheide/Lai",
    "Gotthardstrasse 4 Postfach 162 6490 Andermatt",
    "Roossi 1371 3823 Wengen",
    "Grand-Rue 1 2400 Le Locle",
    "Hinterseestrasse 5 3782 Lauenen b. Gstaad",
    "Dorfstrasse 85 3818 Grindelwald",
    "Marktgasse 49 8400 Winterthur",
    "Via Alpsu 65 7188 Sedrun",
    "Promenade 10 3780 Gstaad",
    "Promenade 152 7260 Davos Dorf",
    "Hinterdorfstrasse 21 8157 Dielsdorf",
    "Plazzet 15 7503 Samedan",
    "Place de la Gare 2 1001 Lausanne",
    "Bergwelt 4 3818 Grindelwald",
    "Rue du Débarcadère 21 2024 Saint-Aubin-Sauges",
    "Gartenweg 5 3715 Adelboden",
    "Viale Verbano 25 6600 Locarno-Muralto",
    "Via principale 53 6914 Carona",
    "Lenkstrasse 8 3775 Lenk im Simmental",
    "Alte Bernstrasse 153 3613 Steffisburg",
    "Kanonenstrasse 6003 Luzern",
    "Route de Berne 150 1010 Lausanne",
    "Untere Tuftra 11 3920 Zermatt",
    "Seestrasse 90 3654 Gunten",
    "Schloss-Strasse 7310 Bad Ragaz",
    "Zürichstrasse 94/96 8600 Dübendorf",
    "Badstrasse 44 5330 Bad Zurzach",
    "Winkelmattenweg 18 3920 Zermatt",
    "Tschuggentorweg 1 7050 Arosa",
    "Rathausgasse 72 3011 Bern",
    "Hauptstrasse 9 7076 Parpan",
    "Schulgässli 51 3812 Wilderswil",
    "Stadthofstrasse 14 6006 Luzern",
    "Place de la gare 1659 Rougemont",
    "Rathausgasse 1-5 3280 Murten",
    "Oeschinenstrasse 49 3718 Kandersteg",
    "Rue de Médran 12 1936 Verbier",
    "Hauptstrasse 5 3286 Muntelier",
    "Rue des Vorziers 7 1920 Martigny",
    "Neumarktstrasse 40 2502 Biel / Bienne",
    "Rue d'Italie 1 1800 Vevey",
    "Route de Fleurs des Champs 17 3963 Crans-Montana",
    "Bahnhofplatz 10 6390 Engelberg",
    "Saflischstrasse 3 3900 Brig",
    "Kantonstrasse 3952 Susten",
    "Bahnhofstrasse 2 6354 Vitznau",
    "Obere Dorfstrasse 6 3715 Adelboden",
    "Davidstrasse 21 9000 St. Gallen",
    "3984 Fiesch",
    "Rue de Rive 15 1260 Nyon",
    "Ruelle des Chevaliers 7 1663 Gruyères",
    "Route de Mauvoisin 380 1948 Lourtier",
    "Route cantonale 31 1025 St-Sulpice VD",
    "Dorfstrasse 15 3715 Adelboden",
    "Centralbahnplatz 3-4 4000 Basel",
    "Bergstation Trübsee 6390 Engelberg",
    "En Bellevue 1 1163 Etoy",
    "Landstrasse 95 7250 Klosters",
    "Seefeldstrasse 63 8008 Zürich",
    "Bahnhofstrasse 67 9240 Uzwil",
    "Via Curtins 2 7500 St. Moritz",
    "Lomattenstrasse 6 3906 Saas-Fee",
    "Röven 53 7530 Zernez",
    "3823 Wengen",
    "Werkhofstrasse 1 7304 Maienfeld",
    "Rue du Rivage 1 1095 Lutry",
    "Turbinenstrasse 20 8005 Zürich",
    "Quai Wilson 37 1201 Genève",
    "Route de Riaz 16 1630 Bulle",
    "Via Sacro Monte 21 6614 Brissago",
    "Seestasse 34 Postfach 6052 Hergiswil NW",
    "Bundesplatz 18 6003 Luzern",
    "Talstrasse 16 3919 Blatten",
    "Schifflände 18 8001 Zürich",
    "Via S. Gottardo 32 6943 Vezia",
    "Centralbahnplatz 14 Postfach 4051 Basel",
    "Rue du Simplon 13 1700 Fribourg",
    "Rue du Puits-Saint-Pierre 1 1204 Genève",
    "Route de Sallaz 6 1071 Rivaz",
    "Neuengasse 15 3001 Bern",
    "Route de Suisse 79 1290 Versoix",
    "Weinplatz 2 8001 Zürich",
    "Untere Bahnhofstrasse 5 8640 Rapperswil SG",
    "Chemin du Mont-Paisible 12 3963 Crans-Montana",
    "Am Grimselpass 3864 Guttannen",
    "Plattenhofstrasse 26 8032 Zürich",
    "Talstrasse 3 7270 Davos Platz",
    "Place du Port 1006 Lausanne",
    "Alte Bernstrasse 11 3322 Urtenen-Schönbühl",
    "Alpinastrasse 23 3780 Gstaad",
    "3992 Bettmeralp",
    "3818 Grindelwald",
    "Limmatstrasse 5 8005 Zürich",
    "Höhenweg 92 3800 Interlaken",
    "Route des Alpes 25 1452 Les Rasses",
    "7504 Pontresina",
    "Bernstrasse West 56 5034 Suhr",
    "Lenkstrasse 43 3775 Lenk im Simmental",
    "Via da Ftan 7550 Scuol",
    "Sporz 7078 Lenzerheide/Lai",
    "Riedstrasse 2 3920 Zermatt",
    "Schiffbaustrasse 11 8005 Zürich",
    "Rue du Parc 5 3963 Crans-Montana",
    "Am Mattenhof 16 6010 Kriens",
    "Weinmarkt 6004 Luzern",
    "Schlossweg 8264 Eschenz",
    "3905 Saas-Almagell",
    "Rue des Pâquis 6 1201 Genève",
    "Falkenstrasse 6 8008 Zürich",
    "Weissbadstrasse 2 Adlerplatz 9050 Appenzell",
    "Dorfstrasse 7533 Fuldera",
    "Laretstrasse 9 7562 Samnaun",
    "Via St. Catrina 12 7180 Disentis / Must�r",
    "Avenue Centrale 152 1884 Villars-sur-Ollon",
    "Les Champs-Blancs 70b 1279 Chavannes-de-Bogis",
    "Schönriedstrasse 74 3792 Saanen",
    "Doldenhornstrasse 26 3718 Kandersteg",
    "Via da la Staziun 7550 Scuol",
    "Via Signor in Croce 1 6612 Ascona",
    "Arvenbüelstrasse 47 8873 Amden",
    "Via Principale 31 7746 Le Prese",
    "3718 Kandersteg",
    "Hauptstrasse 11 3855 Brienz BE",
    "Route de Fleurs des Champs 23 3963 Crans-Montana",
    "Dorfstrasse 24 8784 Braunwald",
    "Hauptstrasse 9650 Nesslau",
    "Bahnhofplatz 11 3011 Bern",
    "Galliweidli 1445 A 3823 Wengen",
    "Poststrasse 27 Bahnhofplatz 9001 St. Gallen",
    "Landsgemeindeplatz 9050 Appenzell",
    "Seeburgstrasse 72 6006 Luzern",
    "7550 Scuol",
    "Via Maistra 26 7524 Zuoz",
    "Place Cornavin 6 1201 Genève",
    "Via Maistra 32 7502 Bever",
    "Dorfstrasse 60 3906 Saas-Fee",
    "Bleicheplatz 1 8201 Schaffhausen",
    "Kantonsstrasse 171 3929 Täsch",
    "Via dal Bagn 54 7500 St. Moritz",
    "Mönchstrasse 37 3600 Thun",
    "Route François-Peyrot 34 1218 Le Grand-Saconnex",
    "Riedweg 156 3920 Zermatt",
    "Schaffhauserstrasse 335 8050 Zürich",
    "Honegg 6373 Ennetbürgen",
    "Zürichstrasse 14 8610 Uster",
    "Heidenweg 26 3235 Erlach",
    "Äussere Dorfstrasse 37 3718 Kandersteg",
    "Sternengässi 7 3954 Leukerbad",
    "Seestrasse 25 6353 Weggis",
    "Dorfstrasse 1 3823 Wengen",
    "Brunnmattgasse 9 3920 Zermatt",
    "Route des Châtaigniers 1 1816 Chailly-Montreux",
    "Viale Stazione 35 6500 Bellinzona",
    "Via da Fex 3 7514 Sils / Segl Maria",
    "Emserstrasse 4 7000 Chur",
    "Route du Belvédère 20 1854 Leysin",
    "Avenue Louis-Casaï 30 1216 Genève-Cointrin",
    "Talstation, Via Murschetg 7032 Laax GR 2",
    "Eichenweg 4-6 3123 Belp",
    "Route des Layeux 1 1884 Villars-sur-Ollon",
    "Promenade 72 3780 Gstaad",
    "Via Paulius 18 7165 Breil / Brigels",
    "Via dal Corvatsch 30 7513 Silvaplana",
    "Seestrasse 36 3700 Spiez",
    "Dorfstrasse 7 3715 Adelboden",
    "c/o Säntis-Schwebebahn AG 9107 Schwägalp / Säntis",
    "Via Traunter Plazzas 6 7500 St. Moritz",
    "Inselistrasse 6 8590 Romanshorn",
    "Bahnhofstrasse 2 3780 Gstaad",
    "Maranerstrasse 7050 Arosa",
    "Im Park 1 9057 Weissbad",
    "Hauptstrasse 81 4528 Zuchwil",
    "Quai du Mont-Blanc 1 1110 Morges",
    "Leonhardsgraben 46 4051 Basel",
    "Central 1 8001 Zürich",
    "Burghaldenstrasse 33 5600 Lenzburg",
    "Gotthardstrasse 76 6490 Andermatt",
    "Rosengasse 10 8001 Zürich",
    "Haus Tamaris, via Cantonale 32 6978 Gandria",
    "Kronenplatz 20 5600 Lenzburg",
    "Hauptstrasse 254 3855 Brienz BE",
    "Scalettastrasse 22 7270 Davos Platz",
    "3963 Crans-Montana",
    "Voa Principala 6 7078 Lenzerheide/Lai",
    "Baslerstrasse 7260 Davos Dorf",
    "Bahnhofstrasse 4 3800 Interlaken",
    "Via Guidino 29 6900 Paradiso",
    "Freiheitsgasse 3 9320 Arbon",
    "Grand Rue 7 1110 Morges",
    "6084 Hasliberg Wasserwendi",
    "Dorfstrasse 168 3818 Grindelwald",
    "Dorfstrasse 40 9108 Gonten",
    "Rue de la Navigation 27 1201 Genève",
    "Voa Sporz 8 7078 Lenzerheide/Lai",
    "Alte Flüelastrasse 2 7260 Davos Dorf",
    "Bühlerstrasse 87 9053 Teufen AR",
    "Goppenstrasse 27 3954 Leukerbad",
    "Julierstrasse 64 7457 Bivio",
    "Postfach 68 3999 Oberwald",
    "Via Carona 41 6900 Lugano Paradiso",
    "Route de Lausanne 301 1293 Bellevue/GE",
    "Höheweg 211 3800 Interlaken",
    "Jungfraustrasse 19 3800 Interlaken",
    "Hauptstrasse 7504 Pontresina",
    "Metallstrasse 20 6302 Zug",
    "Schauenburgerstrasse 76 4410 Liestal",
    "Gewerbestrasse 4 3600 Thun",
    "8, Route de Promenthoux 1197 Prangins",
    "Romanshornerstrasse 15 9320 Arbon",
    "Dorfstrasse 21 7545 Guarda",
    "Weinmarkt 12 6004 Luzern",
    "Dorfstrasse 20 3465 Dürrenroth",
    "Route Principale 3 1984 Les Haudères",
    "Via Somplaz 7512 Champfèr",
    "Viale Castagnola 24 6900 Lugano",
    "Via Maistra 17 7500 St. Moritz",
    "Voa davos Lai 26 7077 Valbella",
    "Seestrasse 36 9326 Horn",
    "Pfingstweidstrasse 102 8005 Zürich",
    "Gerechtigkeitsgasse 18 3011 Bern",
    "Lindenplatz 5 8048 Zürich",
    "Talstrasse 91 3905 Saas-Almagell",
    "Dorfstrasse 58 3778 Schönried",
    "Piazza Motta 6612 Ascona",
    "Rue Bon-Port 27 1820 Montreux",
    "Vicolo delle Olive 11 6612 Ascona",
    "Seestrasse 104 8880 Walenstadt",
    "Ermitagestrasse 16 4144 Arlesheim",
    "Route de la Tourbière 3 1267 Coinsins",
    "Alte Simplonstrasse 6 3900 Brig-Glis",
    "Furrengasse 3 6004 Luzern",
    "Helblingstrasse 9 4852 Rothrist",
    "Spitzhornweg 30 3792 Saanen",
    "Brünigstrasse 130 6060 Sarnen",
    "Rheingasse 12 4058 Basel",
    "Hauptstrasse 125 5015 Erlinsbach",
    "Bielmattweg 1 3906 Saas-Fee",
    "Avenue de Blonay 20 1800 Vevey",
    "3999 Oberwald",
    "Route de Caux 16 1823 Glion",
    "Thunstrasse 80 3074 Muri b. Bern",
    "Breitfeldstrasse 9 9015 St. Gallen",
    "Wolfensberg 9113 Degersheim",
    "Piazza Borromini 6816 Lugano-Bissone",
    "Döltschiweg 234 8055 Zürich",
    "Via Maistra 215 7504 Pontresina",
    "Oberbergstrasse 20 7076 Parpan",
    "via vers Mulins 5 7513 Silvaplana",
    "Im Boden 512 7132 Vals",
    "Waldstättertquai 6 6440 Brunnen",
    "Avenue Benjamin-Constant 5 1003 Lausanne",
    "Herman Greulich Strasse 56 8004 Zürich",
    "Schaffhauserstrasse 101 8152 Glattbrugg",
    "Palacestrasse 28 3780 Gstaad",
    "Stockerstrasse 17 8002 Zürich",
    "35, route de Condémine Bussigny 1030 Bussigny-près-Lausanne",
    "Kochergasse 3-5 3001 Bern",
    "Oberdorf 3812 Wilderswil",
    "Claridenstrasse 30 8002 Zürich",
    "Chemin du Vernex 3 Case postale 112 1865 Les Diablerets",
    "6772 Rodi-Fiesso",
    "Route Principale 3961 St-Luc",
    "Matterstrasse 9 3920 Zermatt",
    "Oberburg 1 8158 Regensberg",
    "Centre du Parc rue Marconi 19 1920 Martigny"
];

const formattedAdresses = adresses.map(address => {
    const res = decomposeAddress(address);
    return res;
});

const outputDir = path.join(__dirname, './outputs');

if (!fs.existsSync(outputDir)) {
    fs.mkdirSync(outputDir);
}

const csvWriter = createCsvWriter({
    path: `outputs/output-addresses-${Date.now()}.csv`,
    header: [
      { id: 'road', title: 'Road/House' },
      { id: 'street', title: 'Street Number' },
      { id: 'postalCode', title: 'Postal Code' },
      { id: 'city', title: 'City' }
    ],
    quote: '"',
    fieldDelimiter: ';',
    encoding: 'utf8',
    append: false
});

csvWriter.writeRecords(formattedAdresses)
  .then(() => {
    console.log('CSV file was written successfully');
  })
  .catch(err => {
    console.error('Error writing CSV file:', err);
  });